"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[7891],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),u=r,h=d["".concat(p,".").concat(u)]||d[u]||m[u]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4433:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:6},i="Frontend",l={unversionedId:"replicate/frontend",id:"replicate/frontend",title:"Frontend",description:"Introduction",source:"@site/docs/replicate/frontend.md",sourceDirName:"replicate",slug:"/replicate/frontend",permalink:"/adsb-nats/next/replicate/frontend",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"defaultSidebar",previous:{title:"Backend",permalink:"/adsb-nats/next/replicate/backend"},next:{title:"Dashboards",permalink:"/adsb-nats/next/replicate/dashboard"}},p={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Tech Stack of the Frontend Airplane Tracker",id:"tech-stack-of-the-frontend-airplane-tracker",level:2},{value:"1. Create the Frontend Airplane Tracker Locally",id:"1-create-the-frontend-airplane-tracker-locally",level:2},{value:"Download Development Tools",id:"download-development-tools",level:3},{value:"React",id:"react",level:4},{value:"Set up a basic React app",id:"set-up-a-basic-react-app",level:3},{value:"Install Packages",id:"install-packages",level:3},{value:"Mapbox",id:"mapbox",level:4},{value:"Mapbox GL Geocoder",id:"mapbox-gl-geocoder",level:4},{value:"Axios",id:"axios",level:4},{value:"Develop a Real-Time Airplane Tracker",id:"develop-a-real-time-airplane-tracker",level:3},{value:"Replace the code in <code>/src/App.js</code> with the following:",id:"replace-the-code-in-srcappjs-with-the-following",level:4},{value:"Replace the code in <code>/src/App.css</code> with the following:",id:"replace-the-code-in-srcappcss-with-the-following",level:4},{value:"You should have included Mapbox stylesheet in <code>/public/index.html</code>",id:"you-should-have-included-mapbox-stylesheet-in-publicindexhtml",level:4},{value:"Deploy the Airplane Tracker app",id:"deploy-the-airplane-tracker-app",level:3},{value:"Future Works",id:"future-works",level:3},{value:'<span id="part-2">2. Using our Frontend Airplane Tracker Visualization</span>',id:"2-using-our-frontend-airplane-tracker-visualization",level:2},{value:"General Instructions:",id:"general-instructions",level:3},{value:"Feature 1: Airplane Marker Popup",id:"feature-1-airplane-marker-popup",level:3},{value:"Feature 2: Search Markers based on Time Intervals",id:"feature-2-search-markers-based-on-time-intervals",level:3},{value:"Feature 3: Filter Markers by Reporter",id:"feature-3-filter-markers-by-reporter",level:3},{value:"Feature 4: Search Markers based on Location",id:"feature-4-search-markers-based-on-location",level:3},{value:"Endnote",id:"endnote",level:2}],c={toc:s},d="wrapper";function m(e){let{components:t,...o}=e;return(0,r.kt)(d,(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"frontend"},"Frontend"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"The application demoed here is an Airplane Tracker, which is similar to some other relevant applications, such as ",(0,r.kt)("a",{parentName:"p",href:"https://flightaware.com/"},"FlightAware")," and ",(0,r.kt)("a",{parentName:"p",href:"https://www.flightradar24.com/"},"Flightradar24"),". However, we ",(0,r.kt)("strong",{parentName:"p"},"want to emphasize")," that the main focus of our work is not on the Airplane Tracker, but instead on the whole pipeline. When you set up the pipeline by following our tutorial, you can create a wide range of applications, not just the Airplane Tracker. The application here can also serve as one place for you to check if your pipeline is working or not. "),(0,r.kt)("h2",{id:"tech-stack-of-the-frontend-airplane-tracker"},"Tech Stack of the Frontend Airplane Tracker"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://react.dev/"},"React"),", ",(0,r.kt)("a",{parentName:"p",href:"https://www.mapbox.com/"},"Mapbox"),", ",(0,r.kt)("a",{parentName:"p",href:"https://aws.amazon.com/amplify/"},"AWS Amplify")),(0,r.kt)("p",null,"You can take a glimpse of the Airplane Tracker application that we made by following through the section below, ",(0,r.kt)("a",{parentName:"p",href:"#part-2"},"Using our Frontend Airplane Tracker Visualization"),". It shall give you some sense of the general functionality of the app."),(0,r.kt)("h2",{id:"1-create-the-frontend-airplane-tracker-locally"},"1. Create the Frontend Airplane Tracker Locally"),(0,r.kt)("h3",{id:"download-development-tools"},"Download Development Tools"),(0,r.kt)("h4",{id:"react"},"React"),(0,r.kt)("p",null,"React: a popular Javascript library for building user interfaces based on components.\nFor more references on React, please refer to the official React website: ",(0,r.kt)("a",{parentName:"p",href:"https://react.dev/"},"https://react.dev/")),(0,r.kt)("p",null,"To download React, you need to download ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en"},"Node.js"),", an open-source, cross-platform Javascript run-time environment that executes Javascript code outside a browser, and node package manager (npm), a dependency management tool for javascript applications."),(0,r.kt)("p",null,"Go to the link ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en/download"},"https://nodejs.org/en/download")," to download Node.js and npm"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," If you have successfully downloaded Node.js and npm, type those commands in the terminal, and they should output the version. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ node -v\n$ npm -v\n")),(0,r.kt)("h3",{id:"set-up-a-basic-react-app"},"Set up a basic React app"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"At any directory you choose, type ",(0,r.kt)("inlineCode",{parentName:"li"},"npm init react-app <project name>")," in the terminal. The command creates a folder named ",(0,r.kt)("inlineCode",{parentName:"li"},"<project name>")," with all required files for a React app."),(0,r.kt)("li",{parentName:"ol"},"Navigate to the folder by typing ",(0,r.kt)("inlineCode",{parentName:"li"},"cd <project name>")),(0,r.kt)("li",{parentName:"ol"},"Start the development server by typing ",(0,r.kt)("inlineCode",{parentName:"li"},"npm start"),". You should see a default web page showing up at ",(0,r.kt)("a",{parentName:"li",href:"http://localhost:3000/"},"http://localhost:3000/"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," Ensure you can see the \u201cLearn React\u201d webpage at http://localhost:3000/ when working on Step 3. The webpage should look like the picture below.\n",(0,r.kt)("img",{alt:"Learn React webpage",src:n(5606).Z,width:"2868",height:"1492"})),(0,r.kt)("p",null,"Let\u2019s look at the structure of the folder in a tree format, with some comments besides the files."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\u251c\u2500\u2500 README.md // instructions on running the react app\n\u251c\u2500\u2500 node_modules // contains actual files for dependencies\n\u251c\u2500\u2500 package-lock.json\n\u251c\u2500\u2500 package.json // metadata of the project\n\u251c\u2500\u2500 public\n\u2502\xa0\xa0 \u251c\u2500\u2500 favicon.ico\n\u2502\xa0\xa0 \u251c\u2500\u2500 index.html // HTML file for serving the react app\n\u2502\xa0\xa0 \u251c\u2500\u2500 logo192.png\n\u2502\xa0\xa0 \u251c\u2500\u2500 logo512.png\n\u2502\xa0\xa0 \u251c\u2500\u2500 manifest.json\n\u2502\xa0\xa0 \u2514\u2500\u2500 robots.txt\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 App.css // CSS styles for the App component\n    \u251c\u2500\u2500 App.js // the App component, the main file to add js code\n    \u251c\u2500\u2500 App.test.js\n    \u251c\u2500\u2500 index.css\n    \u251c\u2500\u2500 index.js // root file for rendering the App component\n    \u251c\u2500\u2500 logo.svg\n    \u251c\u2500\u2500 reportWebVitals.js\n    \u2514\u2500\u2500 setupTests.js\n")),(0,r.kt)("p",null,"To build the Airplane Tracker, here is a list of files that we will modify:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"/src/App.js")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"/src/App.css")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"/src/index.js")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"/public/index.html"))),(0,r.kt)("h3",{id:"install-packages"},"Install Packages"),(0,r.kt)("h4",{id:"mapbox"},"Mapbox"),(0,r.kt)("p",null,"Mapbox: a graphing library for creating interactive map experience"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create an account through ",(0,r.kt)("a",{parentName:"li",href:"https://account.mapbox.com/"},"https://account.mapbox.com/")),(0,r.kt)("li",{parentName:"ol"},"On the account page, click \u201cInstall Mapbox GL JS\u201d (Mapbox GL JS is a Javascript library with Mapbox\u2019s modern mapping technology)\n",(0,r.kt)("img",{alt:"Mapbox Account Page",src:n(736).Z,width:"1850",height:"1330"})),(0,r.kt)("li",{parentName:"ol"},"Pick ",(0,r.kt)("inlineCode",{parentName:"li"},"npm")," as the method for installing Mapbox GL JS"),(0,r.kt)("li",{parentName:"ol"},"Under the ",(0,r.kt)("inlineCode",{parentName:"li"},"<project name>")," directory, type ",(0,r.kt)("inlineCode",{parentName:"li"},"npm install mapbox-gl --save")," in the terminal"),(0,r.kt)("li",{parentName:"ol"},"Include the GL JS CSS file in the ",(0,r.kt)("inlineCode",{parentName:"li"},"<head>")," of ",(0,r.kt)("inlineCode",{parentName:"li"},"/public/index.html")," ",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-html"},"<link href='https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css' rel='stylesheet' />\n")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," If you successfully download Mapbox GL JS, there shall be ",(0,r.kt)("inlineCode",{parentName:"p"},"\u201cmapbox-gl\u201d")," within the dependencies of ",(0,r.kt)("inlineCode",{parentName:"p"},"/package.json"),"."),(0,r.kt)("p",null,"A snapshot of the package.json file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "dependencies": {\n    "@testing-library/jest-dom": "^5.16.5",\n    "@testing-library/react": "^13.4.0",\n    "@testing-library/user-event": "^13.5.0",\n    "mapbox-gl": "^2.14.1",\n    "react": "^18.2.0",\n    "react-dom": "^18.2.0",\n    "react-scripts": "5.0.1",\n    "web-vitals": "^2.1.4"\n  },\n}\n')),(0,r.kt)("p",null,"You also need to create an access token on the Mapbox account page so that you can use all Mapbox APIs inside your project. Within the \u201cAccess tokens\u201d section, you can either use the default public token or create a token on your own. "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Mapbox Access Token Section",src:n(5048).Z,width:"1858",height:"1352"})),(0,r.kt)("p",null,"For more references on Mapbox, please check out its official website: ",(0,r.kt)("a",{parentName:"p",href:"https://www.mapbox.com/"},"https://www.mapbox.com/")),(0,r.kt)("p",null,"For more references on Mapbox GL JS APIs, please check out ",(0,r.kt)("a",{parentName:"p",href:"https://docs.mapbox.com/mapbox-gl-js/guides/"},"https://docs.mapbox.com/mapbox-gl-js/guides/")),(0,r.kt)("h4",{id:"mapbox-gl-geocoder"},"Mapbox GL Geocoder"),(0,r.kt)("p",null,"Mapbox GL Geocoder: A geocoder control for Mapbox GL JS using the Mapbox Geocoding API. The package allows us to add the place search in our application."),(0,r.kt)("p",null,"More references can be found on its GitHub website: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mapbox/mapbox-gl-geocoder"},"https://github.com/mapbox/mapbox-gl-geocoder")),(0,r.kt)("p",null,"To download Mapbox GL Geocoder, under the ",(0,r.kt)("inlineCode",{parentName:"p"},"<project name>")," directory, type ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install --save @mapbox/mapbox-gl-geocoder")," in the terminal"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," If you successfully download Axios, there shall be ",(0,r.kt)("inlineCode",{parentName:"p"},"\u201c@mapbox/mapbox-gl-geocoder\u201d")," within the dependencies of ",(0,r.kt)("inlineCode",{parentName:"p"},"/package.json"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "dependencies": {\n    "@mapbox/mapbox-gl-geocoder": "^5.0.1",\n    "@testing-library/jest-dom": "^5.16.5",\n    "@testing-library/react": "^13.4.0",\n    "@testing-library/user-event": "^13.5.0",\n    "mapbox-gl": "^2.14.1",\n    "react": "^18.2.0",\n    "react-dom": "^18.2.0",\n    "react-scripts": "5.0.1",\n    "web-vitals": "^2.1.4"\n  },\n}\n')),(0,r.kt)("h4",{id:"axios"},"Axios"),(0,r.kt)("p",null,"Axios is a ",(0,r.kt)("a",{parentName:"p",href:"https://javascript.info/promise-basics"},"promised-based")," HTTP client for Node.js and the browser. In simple words, it serves as a client for sending requests to the Flask backend APIs and receiving responses correspondingly."),(0,r.kt)("p",null,"To download Axios, under the ",(0,r.kt)("inlineCode",{parentName:"p"},"<project name>")," directory, type ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install axios")," in the terminal. "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," If you successfully download Axios, there shall be ",(0,r.kt)("inlineCode",{parentName:"p"},"\u201caxios\u201d")," within the dependencies of ",(0,r.kt)("inlineCode",{parentName:"p"},"/package.json"),"."),(0,r.kt)("p",null,"A snapshot of the package.json file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "dependencies": {\n    "@mapbox/mapbox-gl-geocoder": "^5.0.1",\n    "@testing-library/jest-dom": "^5.16.5",\n    "@testing-library/react": "^13.4.0",\n    "@testing-library/user-event": "^13.5.0",\n    "axios": "^1.4.0",\n    "mapbox-gl": "^2.14.1",\n    "react": "^18.2.0",\n    "react-dom": "^18.2.0",\n    "react-scripts": "5.0.1",\n    "web-vitals": "^2.1.4"\n  },\n}\n')),(0,r.kt)("p",null,"More references on Axios can be found at ",(0,r.kt)("a",{parentName:"p",href:"https://axios-http.com/docs/intro"},"https://axios-http.com/docs/intro")),(0,r.kt)("h3",{id:"develop-a-real-time-airplane-tracker"},"Develop a Real-Time Airplane Tracker"),(0,r.kt)("p",null,"In the section, we will start adding code in different places within the project folder so we can have a real-time airplane tracker."),(0,r.kt)("h4",{id:"replace-the-code-in-srcappjs-with-the-following"},"Replace the code in ",(0,r.kt)("inlineCode",{parentName:"h4"},"/src/App.js")," with the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},'import \'./App.css\';\nimport React, { useRef, useEffect, useState } from \'react\';\nimport axios from \'axios\';\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport mapboxgl from \'!mapbox-gl\';\nimport MapboxGeocoder from \'@mapbox/mapbox-gl-geocoder\';\nimport \'@mapbox/mapbox-gl-geocoder/dist/mapbox-gl-geocoder.css\';\n\n// please paste your Mapbox access token here\nmapboxgl.accessToken = \'\';\n\n// hyperparameters set for the app\nconst PAST_TIME = 90 * 1000;    // when the app loads, fetch the airplane data from the past 90s\nconst UPDATE_TIME = 20 * 1000;  // the app updates with new data every 20s\nconst WINDOW_TIME = 30 * 1000;  // with each update, the appes the data from the past 30s\nconst FLUSH_LIMIT = 1200;       // the app does a flush when the number of markers on the map exceeds 1200\nconst Modes = {\n    REAL_TIME: "real_time",\n}\n\nconst colorMap = new Map();     // a map to give unique colors to different planes\n\nconst App = () => {\n  // set up states for the app\n  // set up Mapbox map element\n  const map = useRef(null);\n  const mapContainerRef = useRef(null);\n\n  // variable to keep track of airplane markers elements\n  const markers = useRef([]);\n\n  // keep track of the current mode: real_time (used in our app with advanced features)\n  const [mode, setMode] = useState(Modes.REAL_TIME);\n\n  /**\n   * \n   * @param {*} timeDate: a Javascript Date object\n   * @returns param: a time string that can be used to construct Flask backend API url\n   */\n  const getTimeParam = (timeDate) => {\n    const [date, timeInfo] = timeDate.toISOString().split("T");\n    const time = timeInfo.split(".")[0];\n\n    const param = date + "T" + time;\n    return param;\n  }\n\n  /**\n   * \n   * @param {*} url: a string that refers to the Flask backend API url\n   * the function makes a request to the url, gets the response, and displays new airplane markers\n   */\n  const getFlightRequest = (url) => {\n    // use axios to make a request to the Flask backend\n    axios.get(url)\n    .then(res => {\n      // the frontend gets response from the Flask backend\n\n      // clean data\n      let data = res.data.map((dataItem) => {\n        if ("_source" in dataItem && "inner_hits" in dataItem)  {\n          return {"_source": dataItem["_source"], "inner_hits": dataItem["inner_hits"]};\n        }\n      });\n\n      data = data.filter((dataItem) => ("lon" in dataItem["_source"] && "lat" in dataItem["_source"]));\n\n      // fetch only the last 500 datapoints from the data to avoid rendering too many data\n      if (mode === Modes.REAL_TIME) {\n        data = data.slice(-500);\n      }\n\n      // an array to store new airplane markers\n      const markersTemp = [];\n\n      // Render custom marker components\n      data.forEach((dataItem) => {\n        // determine marker color\n        var color;\n        const source = dataItem["_source"];\n        const icao = source["ICAO"].toUpperCase();\n        if (colorMap.has(icao)){\n          color = colorMap.get(icao);\n        } else {\n          const randomColor = "#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, \'0\').toUpperCase();\n          colorMap.set(icao, randomColor);\n          color = colorMap.get(icao);\n        }\n        \n        // create a parent class for the marker\n        const el = document.createElement(\'div\');\n        el.className = \'marker\';\n        el.style.backgroundColor = color;\n\n        // fetch info to be displayed in the marker popup\n        const time = new Date(source.time + "Z");\n        const dateString = time.toLocaleDateString();\n        const timeString = time.toLocaleTimeString();\n\n        const {aircraft, manufacturer, feet, registered} = source;\n        let {reporter_uid} = source;\n        const airplaneType = manufacturer === "unknown"? "not available" : manufacturer + \' \' + aircraft;\n        reporter_uid = reporter_uid === undefined? "anonymous user" : reporter_uid;\n\n        // Create a Mapbox Marker at our new DOM node\n        const marker = new mapboxgl.Marker(el)\n          .setPopup(\n            new mapboxgl.Popup({ offset: 10, maxWidth: \'300px\'}) // add popup\n            .setHTML(\n              `\n              <div>\n                <div><strong>ICAO:</strong> ${icao}</div>\n                <div><strong>Altitude:</strong> ${feet} ft</div>\n                <div><strong>Time:</strong> ${dateString + \' \' + timeString}</div>\n                <div><strong>Aircraft:</strong> ${airplaneType}</div>\n                <div><strong>Registered by:</strong> ${registered}</div>\n              </div>\n              `\n            )\n          )\n          .setLngLat([source["lon"], source["lat"]])\n          .addTo(map.current);\n        marker.time = time;\n        marker.reporter = reporter_uid;\n        markersTemp.push(marker);\n      });\n\n      if (mode === Modes.REAL_TIME) {\n        // combine new markers with the existing markers\n        let newMarkers = [...markers.current, ...markersTemp];\n\n        // the app flushes the data when the number of markers is over the limit\n        if (newMarkers.length >= FLUSH_LIMIT) {\n          // sort all markers based on time ascending and only keep last 500 markers\n          newMarkers.sort((a, b) => a.time.getTime() - b.time.getTime());\n          const tempMarkers = newMarkers.slice(0, newMarkers.length - 500);\n          tempMarkers.forEach(marker => marker.remove());\n          newMarkers = newMarkers.slice(-500);\n        }\n        markers.current = newMarkers;\n      } \n\n      // Clean up on unmount\n      return () => map.current.remove(); \n    })    \n  }\n\n  /**\n   * \n   * @param {*} timeDiff: a number that represents time in milliseconds\n   * the function constructs the API call and let the getFlightRequest function handle the url call\n   */\n  const getFlightData = (timeDiff) => {\n    const now = Date.now();\n    const startTime = getTimeParam(new Date(now - timeDiff));\n    const endTime = getTimeParam(new Date(now));\n    const url = `https://elastic.spectrumdatapipeline.net/getJsonStreamCompress?start_date=${startTime}&&end_date=${endTime}`;\n    getFlightRequest(url);\n  }\n\n  /**\n   * \n   * @param {*} longitude: a number that represents longitude\n   * @param {*} latitude: a number that represents latitude\n   * the function uses these two parameters to construct a map\n   * \n   */\n  const renderMap = (longitude, latitude) => {\n    map.current = new mapboxgl.Map({\n      container: mapContainerRef.current,\n      style: "mapbox://styles/mapbox/streets-v11",\n      center: [longitude, latitude],\n      zoom: 9,\n    });\n\n    // add a Geocoder to enable place search\n    map.current.addControl(new MapboxGeocoder({\n      accessToken: mapboxgl.accessToken,\n      mapboxgl: mapboxgl,\n      language: "en-EN",\n    }), "top-right");\n    map.current.addControl(new mapboxgl.NavigationControl(), "top-right");\n  }\n\n  // when the app loads, get browser permission on device location\n  // and render the map\n  useEffect(() => {\n    if (map.current) return;\n\n    var longitude = -122.3;\n    var latitude = 37.8;\n\n    // enable browser permission on device permission\n    if (navigator.permissions) {\n      navigator.permissions.query({name:\'geolocation\'}).then((result) => {\n        if (result.state === \'denied\') {\n          console.log("Geolocation not supported by the browser");\n          renderMap(longitude, latitude);        \n        } else if (result.state === "prompt") {\n          navigator.geolocation.getCurrentPosition((position) => {\n            longitude = position.coords.longitude;\n            latitude = position.coords.latitude;\n            renderMap(longitude, latitude);\n          }, (err) => {\n            console.log("Geolocation not supported by the browser");\n            renderMap(longitude, latitude);\n          });\n        } else if (result.state === "granted") {\n          if (navigator.gelocation) {\n            navigator.geolocation.getCurrentPosition((position) => {\n              longitude = position.coords.longitude;\n              latitude = position.coords.latitude;\n              renderMap(longitude, latitude);\n            });   \n          } else {\n            console.log("Geolocation not supported by the browser");\n            renderMap(longitude, latitude);  \n          } \n        }\n      });\n    } else {\n      console.log("Geolocation not supported by the browser");\n      renderMap(longitude, latitude);  \n    }\n  }, [])\n\n  useEffect(() => {\n    if (mode === Modes.REAL_TIME) {\n      // when the app first loads, gets airplane data in the past PAST_TIME\n      getFlightData(PAST_TIME);\n\n      // the app updates the map every UPDATE_TIME, fetching data in the past WINDOW_TIME\n      const updateInterval = setInterval(() => {\n        getFlightData(WINDOW_TIME);\n      }, UPDATE_TIME);\n\n      return () => {\n        clearInterval(updateInterval);\n      };\n    } \n  }, [mode])\n  \n  return (\n    <div className="container">\n      <div className="form">\n        <div>\n          Map is automatically updated with live data every {UPDATE_TIME / 1000} seconds\n        </div>   \n      </div>\n      <div className="map-container" ref={mapContainerRef} />\n    </div>\n  );\n};\n\nexport default App;\n')),(0,r.kt)("p",null,"The above code block contains comments along the way for you to understand the general structure, and, if you have any React-specific questions, please refer to ",(0,r.kt)("a",{parentName:"p",href:"https://react.dev/"},"https://react.dev/")),(0,r.kt)("p",null,"In the above code block, there are ",(0,r.kt)("strong",{parentName:"p"},"two lines")," you need to modify"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Add your own Mapbox access token ",(0,r.kt)("inlineCode",{parentName:"li"},"mapboxgl.accessToken = '';")),(0,r.kt)("li",{parentName:"ol"},"In the ",(0,r.kt)("inlineCode",{parentName:"li"},"getFlightData")," function, replace the ",(0,r.kt)("inlineCode",{parentName:"li"},"url")," variable with the API call you created in ",(0,r.kt)("a",{parentName:"li",href:"/adsb-nats/next/replicate/backend"},"Websever & Backend"))),(0,r.kt)("h4",{id:"replace-the-code-in-srcappcss-with-the-following"},"Replace the code in ",(0,r.kt)("inlineCode",{parentName:"h4"},"/src/App.css")," with the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-css"},'.App {\n  text-align: center;\n}\n\n.container {\n  position: relative;\n}\n\n.form {\n  position: absolute;\n  z-index: 5;\n  top: 10px;\n  left: 10px;\n}\n\n.marginTop {\n  margin-top: 1rem;\n}\n\n.bg-w {\n  background-color: white;\n}\n\n.map-container {\n  height: 100vh;\n}\n\n.mapboxgl-ctrl-geocoder {\n  width: 275px!important;\n}\n\n.marker {\n    /* border: 1px solid black; */\n    color: white;\n    padding: 5px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 6px;\n    margin: 4px 2px;\n    border-radius: 50%;\n    width: 4px;\n    height: 4px;\n    content: "\\2708";\n    /* background-image: url(https://cdn-icons-png.flaticon.com/512/0/614.png); */\n    background-image: url(https://static.vecteezy.com/system/resources/previews/014/455/865/original/plane-icon-icon-on-transparent-background-free-png.png);\n    background-size: contain;\n    background-repeat: no-repeat;\n    cursor: pointer;\n}\n')),(0,r.kt)("p",null,"The file adds CSS style to the HTML elements created in ",(0,r.kt)("inlineCode",{parentName:"p"},"/src/App.js")),(0,r.kt)("h4",{id:"you-should-have-included-mapbox-stylesheet-in-publicindexhtml"},"You should have included Mapbox stylesheet in ",(0,r.kt)("inlineCode",{parentName:"h4"},"/public/index.html")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="utf-8" />\n    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />\n    <meta name="viewport" content="width=device-width, initial-scale=1" />\n    <meta name="theme-color" content="#000000" />\n    <meta\n      name="description"\n      content="Web site created using create-react-app"\n    />\n    <link href=\'https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.css\' rel=\'stylesheet\' />\n    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />\n    \x3c!--\n      manifest.json provides metadata used when your web app is installed on a\n      user\'s mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/\n    --\x3e\n    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />\n    \x3c!--\n      Notice the use of %PUBLIC_URL% in the tags above.\n      It will be replaced with the URL of the `public` folder during the build.\n      Only files inside the `public` folder can be referenced from the HTML.\n\n      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will\n      work correctly both with client-side routing and a non-root public URL.\n      Learn how to configure a non-root public URL by running `npm run build`.\n    --\x3e\n    <title>React App</title>\n  </head>\n  <body>\n    <noscript>You need to enable JavaScript to run this app.</noscript>\n    <div id="root"></div>\n    \x3c!--\n      This HTML file is a template.\n      If you open it directly in the browser, you will see an empty page.\n\n      You can add webfonts, meta tags, or analytics to this file.\n      The build step will place the bundled scripts into the <body> tag.\n\n      To begin the development, run `npm start` or `yarn start`.\n      To create a production bundle, use `npm run build` or `yarn build`.\n    --\x3e\n  </body>\n</html>\n')),(0,r.kt)("p",null,"After you have done all those changes, run ",(0,r.kt)("inlineCode",{parentName:"p"},"npm start")," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"<project name>")," directory in the terminal, and you can access the app through ",(0,r.kt)("a",{parentName:"p",href:"http://localhost:3000/"},"http://localhost:3000/"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," When you access the app, you can see the map showing up with airplane markers in real time, just like the picture below. You can also see that the markers are updating every 20 seconds."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Airplane Tracker",src:n(171).Z,width:"2872",height:"1352"})),(0,r.kt)("h3",{id:"deploy-the-airplane-tracker-app"},"Deploy the Airplane Tracker app"),(0,r.kt)("p",null,"AWS Amplify provides an easy way for users to deploy the app on a public URL that everyone can access. "),(0,r.kt)("p",null,"To use AWS Amplify to deploy the application, please follow the link below:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.amplify.aws/start/q/integration/react/"},"https://docs.amplify.aws/start/q/integration/react/")),(0,r.kt)("p",null,"Specifically, you only need to follow these steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in with your AWS account, and configure the Amplify CLI (",(0,r.kt)("a",{parentName:"p",href:"https://docs.amplify.aws/start/getting-started/installation/q/integration/react/"},"https://docs.amplify.aws/start/getting-started/installation/q/integration/react/"),")")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Initialize a new backend, Install Amplify Libraries, and Set up Frontend ",(0,r.kt)("strong",{parentName:"p"},"(You have already done the \u201cCreate a new React App\u201d step)")," (",(0,r.kt)("a",{parentName:"p",href:"https://docs.amplify.aws/start/getting-started/setup/q/integration/react/"},"https://docs.amplify.aws/start/getting-started/setup/q/integration/react/"),")"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Checkpoints:")," "),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"you will see the ",(0,r.kt)("inlineCode",{parentName:"p"},"amplify")," folder under the ",(0,r.kt)("inlineCode",{parentName:"p"},"<project name>")," directory. ")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("inlineCode",{parentName:"p"},"/package.json")," should have those dependencies with ",(0,r.kt)("inlineCode",{parentName:"p"},'"aws-amplify"'),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "dependencies": {\n    "@mapbox/mapbox-gl-geocoder": "^5.0.1",\n    "@testing-library/jest-dom": "^5.16.5",\n    "@testing-library/react": "^13.4.0",\n    "@testing-library/user-event": "^13.5.0",\n    "aws-amplify": "^5.2.1",\n    "axios": "^1.4.0",\n    "mapbox-gl": "^2.14.1",\n    "react": "^18.2.0",\n    "react-dom": "^18.2.0",\n    "react-scripts": "5.0.1",\n    "web-vitals": "^2.1.4"\n  },\n}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Your ",(0,r.kt)("inlineCode",{parentName:"p"},"/src/index.js")," should look like the following:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { Amplify } from 'aws-amplify';\nimport awsExports from './aws-exports';\nAmplify.configure(awsExports);\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The app should still work when you run ",(0,r.kt)("inlineCode",{parentName:"p"},"npm start"))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Deploy and host the app (",(0,r.kt)("a",{parentName:"p",href:"https://docs.amplify.aws/start/getting-started/hosting/q/integration/react/"},"https://docs.amplify.aws/start/getting-started/hosting/q/integration/react/"),") "))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Checkpoint:")," After following the instructions in the link, you should get a URL in the form of ",(0,r.kt)("a",{parentName:"p",href:"https://dev.d4a2n7mhawdy0.amplifyapp.com/"},"https://dev.d4a2n7mhawdy0.amplifyapp.com/"),". You can access the Airplane Tracker through your URL. Now, you have deployed your app!"),(0,r.kt)("h3",{id:"future-works"},"Future Works"),(0,r.kt)("p",null,"Congratulations, you have created your own Airplane Tracker! Our Airplane Tracker included advanced functionalities, such as searching based on time intervals, sorting by reporter type, etc. You can learn more about these features on the Using our Frontend Airplane Tracker Visualization section. Feel free to check out our application at ",(0,r.kt)("a",{parentName:"p",href:"https://tinyurl.com/specpipe"},"https://tinyurl.com/specpipe")," and the corresponding source code at ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ml4wireless/adsb-nats/tree/master/frontend"},"https://github.com/ml4wireless/adsb-nats/tree/master/frontend"),". "),(0,r.kt)("h2",{id:"2-using-our-frontend-airplane-tracker-visualization"},(0,r.kt)("span",{id:"part-2"},"2. Using our Frontend Airplane Tracker Visualization")),(0,r.kt)("h3",{id:"general-instructions"},"General Instructions:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Visit the frontend page: ",(0,r.kt)("a",{parentName:"li",href:"https://tinyurl.com/specpipe"},(0,r.kt)("strong",{parentName:"a"},"https://tinyurl.com/specpipe"))),(0,r.kt)("li",{parentName:"ul"},"You can choose to allow your browser to see your location, and then the map should center around your location. Otherwise, the map will center around Berkeley, CA by default."),(0,r.kt)("li",{parentName:"ul"},"Every airplane dot/marker on the map represents a logged location at a certain time, with a trail of the same color markers representing a single plane."),(0,r.kt)("li",{parentName:"ul"},"The Airplane Tracker application updates the map in ",(0,r.kt)("strong",{parentName:"li"},"real time")," with new airplane data every 20 seconds. The application cleans parts of the data when the number of markers is over a certain limit."),(0,r.kt)("li",{parentName:"ul"},"To test:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Wait and watch for current data points to show up")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Should look like the image below after some time has passed"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{alt:"Screen Shot 2023-05-10 at 4.12.35 PM.png",src:n(1211).Z,width:"2864",height:"1304"})))))),(0,r.kt)("p",null,"The application also provides additional functionalities. "),(0,r.kt)("h3",{id:"feature-1-airplane-marker-popup"},"Feature 1: Airplane Marker Popup"),(0,r.kt)("p",null,"As you click on any marker on the map in the Airplane Tracker application, a popup will display additional information such as the airplane\u2019s ICAO number, altitude, time of location broadcast, the aircraft type, etc., as can be seen in the image below."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Airplane marker popup",src:n(4508).Z,width:"524",height:"394"})),(0,r.kt)("h3",{id:"feature-2-search-markers-based-on-time-intervals"},"Feature 2: Search Markers based on Time Intervals"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"There is an option to select a desired interval and see the plane trajectories during that time range using the calendar tool in the top-left corner of the application."),(0,r.kt)("li",{parentName:"ul"},"In the image shown below, we specified the start time to be 10:00 am on May 8, 2023 and the end time to be 10:04 am on May 8, 2023."),(0,r.kt)("li",{parentName:"ul"},"Make sure to select a max time range of 4 minutes to prevent too many airplane markers","  ",(0,r.kt)("img",{alt:"Screen Shot 2023-05-10 at 10.07.27 PM.png",src:n(1080).Z,width:"2866",height:"1300"}))),(0,r.kt)("h3",{id:"feature-3-filter-markers-by-reporter"},"Feature 3: Filter Markers by Reporter"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"To distinguish between different reporters, the Airplane Tracker application has a \u201cfilter by reporter\u201d functionality using the \u201cSelect Reporter\u201d dropdown in the left corner of the application."),(0,r.kt)("li",{parentName:"ul"},"Select a specific reporter under the dropdown, and the application only shows the airplane markers with this reporter type.","  ",(0,r.kt)("img",{alt:"Screen Shot 2023-05-10 at 10.14.14 PM.png",src:n(6223).Z,width:"1250",height:"752"}))),(0,r.kt)("h3",{id:"feature-4-search-markers-based-on-location"},"Feature 4: Search Markers based on Location"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Using the search box in the top-right corner of the application, users can provide a specific location, and the map will center around the location, just like the image below.","  ",(0,r.kt)("img",{alt:"Screen Shot 2023-05-10 at 10.20.06 PM.png",src:n(2837).Z,width:"2866",height:"1296"}))),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"endnote"},"Endnote"),(0,r.kt)("p",null,"In the end, this Airplane Tracker application gives you a glimpse of what we could do with the pipeline and the wireless spectrum radio data. We hope that this could be a motivation for you to develop creative applications using wireless spectrum!"))}m.isMDXComponent=!0},1211:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_1-39a77dfe0fb25fc58c512ba0432e20e9.png"},4508:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_2-390711748315c1aca2cda5b245b9bf21.png"},1080:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_3-13f61577cc115acf95b9fb7631d2cf07.png"},6223:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_4-d01012699c143500a52698e9af1e9ee4.png"},2837:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_5-c5d4a411202baebff33ee317ddeb00f6.png"},5606:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_6-58cceb26ea190a41657976293ed2d601.png"},736:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_7-2cfda6953e47bf7a3ef4f88078f19169.png"},5048:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_8-27bc6c26b01439ec8683d8a1b9dac0c9.png"},171:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/frontend_9-b2f74742fca3e4f8f97ca6b33bccbe9c.png"}}]);